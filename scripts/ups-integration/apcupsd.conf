## apcupsd.conf - UPS daemon configuration
##
## This configuration is for USB-connected APC UPS units.
## Adjust BATTERYLEVEL and MINUTES based on your shutdown time needs.
##
## INSTALL:
##   sudo cp apcupsd.conf /etc/apcupsd/
##   sudo sed -i 's/ISCONFIGURED=no/ISCONFIGURED=yes/' /etc/default/apcupsd
##   sudo systemctl restart apcupsd
##   sudo systemctl enable apcupsd

# ============================================================================
# UPS IDENTIFICATION
# ============================================================================

# Name of your UPS (shows in logs and status)
UPSNAME LightningUPS

# Cable type - "usb" for USB-connected UPS
UPSCABLE usb

# UPS type - "usb" for USB-connected UPS
UPSTYPE usb

# Device path - leave blank for USB auto-detection
DEVICE

# ============================================================================
# NETWORK INFORMATION SERVER
# ============================================================================

# Enable network server for status queries (apcaccess)
NETSERVER on

# IP to listen on (127.0.0.1 = localhost only, 0.0.0.0 = all interfaces)
NISIP 127.0.0.1

# Port for network information server
NISPORT 3551

# ============================================================================
# SHUTDOWN THRESHOLDS - CRITICAL SETTINGS
# ============================================================================

# Seconds to wait before reacting to power failure
# Prevents shutdown on momentary power blips
ONBATTERYDELAY 6

# Shutdown when battery level drops to this percentage
# Set high enough to allow ~4 minutes for graceful shutdown
BATTERYLEVEL 20

# Shutdown when this many minutes of runtime remain
# Should be > your shutdown script time (recommend 10 for ~4 min shutdown)
MINUTES 10

# Shutdown after this many seconds on battery (0 = disable)
# Usually disabled in favor of BATTERYLEVEL and MINUTES
TIMEOUT 0

# ============================================================================
# USER NOTIFICATION
# ============================================================================

# Time between "annoy" messages when on battery (seconds)
ANNOY 300

# Delay before first "annoy" message (seconds)
ANNOYDELAY 60

# ============================================================================
# POWER CONTROL
# ============================================================================

# Delay before UPS kills power after shutdown command (0 = don't kill)
# Usually 0 - let UPS manage its own power state
KILLDELAY 0

# ============================================================================
# LOGIN CONTROL
# ============================================================================

# Control logins when on battery
# "disable" = disable new logins when on battery
# "timeout" = disable after TIMEOUT seconds on battery
# "percent" = disable at BATTERYLEVEL percent
# "minutes" = disable at MINUTES remaining
# "always" = always disable (not recommended)
NOLOGON disable

# ============================================================================
# LOGGING
# ============================================================================

# Syslog facility
FACILITY DAEMON

# Status file location
STATFILE /var/log/apcupsd.status

# Events file location
EVENTSFILE /var/log/apcupsd.events

# Log status every N seconds (0 = disable)
STATTIME 0

# Log data every N seconds (0 = disable)
DATATIME 0

# Enable statistics logging
LOGSTATS off

# ============================================================================
# SCRIPT AND LOCK FILES
# ============================================================================

# Directory containing apccontrol and hook scripts
SCRIPTDIR /etc/apcupsd

# Directory for power fail flag file
PWRFAILDIR /etc/apcupsd

# Lock file location
LOCKFILE /var/lock

# ============================================================================
# UPS SHARING (usually standalone)
# ============================================================================

# UPS class: standalone, shareslave, or sharemaster
UPSCLASS standalone

# UPS mode: disable, share
UPSMODE disable
